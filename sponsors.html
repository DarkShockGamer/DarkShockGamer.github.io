<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" type="image/png" href="/assets/logo.png">
  <link rel="shortcut icon" type="image/png" href="/assets/logo.png">
  <title>Trident Robotics 4296 - Sponsors</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Identity Services -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <!-- Include JWT decode library -->
  <script src="https://cdn.jsdelivr.net/npm/jwt-decode@3/build/jwt-decode.min.js"></script>

  <style>
    /* ====== Colors ====== */
    :root {
      --dark-blue: #0a1f44;
      --medium-blue: #1f4d7a;
      --light-blue: #4fa3d1;
      --white: #f4f8fb;
      --accent: #ffd700;

      /* Logo frame styling */
      --logo-frame-bg: rgba(255,255,255,0.04);
      --logo-frame-border: rgba(79,163,209,0.35);
      --logo-frame-shadow: 0 6px 16px rgba(0,0,0,0.35);
    }

    @font-face {
      font-family: 'Ethnocentric';
      src: url('/assets/fonts/Ethnocentric Rg.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    /* ====== Global Styles ====== */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(-45deg, #050c24, #0a1f44);
      color: var(--white);
      line-height: 1.6;
    }
    a { text-decoration: none; color: inherit; }

    /* Global image reset (content images) */
    img { display: block; max-width: 100%; height: auto; }

    /* Keep the Google sign-in button intact */
    #googleSignIn img, #googleSignIn svg {
      display: inline-block !important;
      max-width: none !important;
      width: auto !important;
      height: auto !important;
      vertical-align: middle !important;
    }
    #googleSignIn { display: inline-block; }

    /* ====== Sections, headings (match index) ====== */
    section { padding: 3rem 1.5rem; max-width: 1100px; margin: auto; }
    h2 {
      color: var(--light-blue);
      font-size: 2rem;
      border-bottom: 3px solid var(--light-blue);
      display: inline-block;
      margin-bottom: 1.5rem;
      padding-bottom: 0.25rem;
    }

    /* ====== Hero Header (image on top) ====== */
    header {
      position: relative;
      height: 45vh;
      min-height: 360px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: var(--white);
      overflow: hidden;
      border-bottom: 3px solid var(--light-blue);
    }
    header img.hero-bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      filter: brightness(0.55);
      z-index: -1;
    }
    header h1 {
      font-family: 'Ethnocentric', sans-serif;
      font-size: 2.6rem;
      font-weight: 800;
      letter-spacing: 1px;
      margin-bottom: 0.8rem;
      text-shadow: 0 4px 12px rgba(0,0,0,0.6);
    }
    header p {
      font-size: 1.15rem;
      color: #e0f2ff;
      opacity: 0.95;
      max-width: 900px;
      padding: 0 1rem;
    }
    .sponsor-button {
      margin-top: 1.1rem;
      background: var(--accent);
      color: var(--dark-blue);
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 800;
      letter-spacing: .3px;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }
    .sponsor-button:hover {
      background: #e6c200;
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    }

    /* ====== Navigation (copied from index and placed below header) ====== */
    .site-nav {
      background: var(--medium-blue);
      display: flex;
      align-items: center;
      position: sticky;
      top: 0;
      z-index: 1000;
      border-bottom: 3px solid var(--light-blue);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    .nav-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      position: relative;
      padding: 0.6rem 1rem;
      width: 100%;
    }
    .nav-logo img { height: 50px; width: auto; }
    .nav-logo img:hover { filter: drop-shadow(0 0 6px var(--accent)); }

    .nav-links {
      display: flex;
      justify-content: center;
      gap: 1rem;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
    }
    .nav-links a {
      font-weight: bold;
      text-transform: uppercase;
      padding: 0.25rem 0.5rem;
      border-bottom: 2px solid transparent;
      transition: 0.25s;
    }
    .nav-links a:hover {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .nav-toggle {
      justify-self: end;
      display: none;
      width: 40px;
      height: 40px;
      background: none;
      border: none;
      cursor: pointer;
      position: relative;
      z-index: 1002;
    }
    .nav-toggle .hamburger,
    .nav-toggle .hamburger::before,
    .nav-toggle .hamburger::after {
      display: block;
      width: 22px;
      height: 2px;
      background: var(--white);
      border-radius: 2px;
      position: absolute;
      left: 50%;
      top: 50%;
      transform: translateX(-50%);
      content: "";
    }
    .nav-toggle .hamburger::before { top: -7px; }
    .nav-toggle .hamburger::after  { top: 7px; }

    /* Mobile dropdown (match index) */
    .nav-links-mobile {
      display: none;
      flex-direction: column;
      background: var(--medium-blue);
      position: absolute;
      top: 100%;
      left: 0;
      width: 100%;
      border-top: 3px solid var(--light-blue);
      z-index: 1001;
    }
    .nav-links-mobile a {
      padding: 0.8rem 0;
      text-align: center;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }
    .nav-links-mobile.show { display: flex; }

    /* ====== Google Login in Nav (match index) ===== */
    .nav-login { justify-self: end; display: flex; align-items: center; gap: .5rem; }
    .nav-login .google-btn {
      display: flex;
      align-items: center;
      background: var(--medium-blue);
      color: var(--white);
      border: 2px solid var(--accent);
      padding: 0.4rem 0.8rem;
      border-radius: 8px;
      font-weight: bold;
      font-size: 0.9rem;
      cursor: pointer;
      transition: 0.3s;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3);
    }
    .nav-login .google-btn:hover {
      background: var(--light-blue);
      color: var(--dark-blue);
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    }
    .nav-login .google-btn img {
      height: 18px;
      margin-right: 6px;
    }

    /* small inline signed-in UI */
    #googleSignedIn {
      display: none;
      align-items: center;
      gap: 0.5rem;
    }
    #googleSignedIn img { height: 28px; width: 28px; border-radius: 50%; object-fit: cover; border: 2px solid rgba(255,255,255,0.08); }
    #googleEmail { font-weight: 600; font-size: 0.95rem; color: var(--white); max-width: 180px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

    /* ====== Sponsors Grid (cards) ====== */
    .sponsors-section { padding-top: 3rem; }
    .sponsor-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: clamp(1rem, 2vw, 2rem);
      justify-items: stretch;
      align-items: stretch;
      overflow: visible;
    }

    .sponsor-card {
      background: linear-gradient(135deg, #0a1f44, #183f6c 40%, #2c74a0);
      padding: 0.9rem 0.9rem 1rem;
      border-radius: 16px;
      color: var(--white);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      justify-content: space-between;
      position: relative;
      will-change: transform, box-shadow;
      transition: transform 0.25s ease, box-shadow 0.25s ease, border-color .25s ease;
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.06);
      overflow: visible;
      height: 100%;
    }

    /* Card interactive states (only on hover-capable devices) */
    @media (hover: hover) and (pointer: fine) {
      .sponsor-card:hover,
      .sponsor-card:focus-within {
        transform: translateY(-6px);
        box-shadow: 0 14px 28px rgba(0,0,0,0.35);
        z-index: 2;
        border-color: rgba(79,163,209,0.55);
      }
    }

    /* Make entire card clickable when link is present */
    .sponsor-card > a {
      display: flex;
      flex-direction: column;
      align-items: stretch;
      justify-content: space-between;
      height: 100%;
      width: 100%;
      border-radius: 14px;
      outline: none;
    }
    .sponsor-card > a:focus-visible {
      box-shadow: 0 0 0 3px rgba(79,163,209,0.6), 0 0 0 6px rgba(10,31,68,0.6);
    }

    /* Uniform logo frame for consistent sizing */
    .sponsor-media {
      width: 100%;
      aspect-ratio: 16 / 9;            /* consistent across all screens */
      display: grid;
      place-items: center;
      padding: clamp(0.5rem, 1.2vw, 0.9rem);
      border-radius: 12px;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.02)) padding-box,
        linear-gradient(135deg, rgba(79,163,209,0.6), rgba(79,163,209,0.15)) border-box;
      border: 1.5px solid var(--logo-frame-border);
      box-shadow: var(--logo-frame-shadow);
      position: relative;
      overflow: hidden;
      isolation: isolate;
    }
    /* Subtle glossy highlight */
    .sponsor-media::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(120% 60% at -10% -20%, rgba(255,255,255,0.18), transparent 60%),
                  radial-gradient(120% 60% at 110% 120%, rgba(255,255,255,0.08), transparent 60%);
      pointer-events: none;
      z-index: -1;
    }

    /* Logo sizing: fill the frame without cropping, avoid tiny render */
    .sponsor-logo {
      width: auto;
      height: auto;
      max-width: min(92%, 520px);
      max-height: 76%;                 /* leave breathing room in the frame */
      object-fit: contain;
      object-position: center;
      filter: grayscale(8%) drop-shadow(0 0 6px rgba(255,255,255,0.22));
      transition: filter .25s ease, transform .25s ease;
      will-change: transform;
    }

    @media (hover: hover) and (pointer: fine) {
      .sponsor-card:hover .sponsor-logo,
      .sponsor-card:focus-within .sponsor-logo {
        filter: grayscale(0%) drop-shadow(0 0 10px rgba(255,255,255,0.35));
        transform: translateZ(0) scale(1.02);
      }
    }

    .sponsor-name {
      font-weight: 700;
      letter-spacing: .3px;
      text-align: center;
      margin-top: 0.7rem;
      padding: 0 0.25rem;
      font-size: clamp(0.95rem, 1.2vw, 1.05rem);
      color: #e7f5ff;
      text-shadow: 0 1px 0 rgba(0,0,0,0.3);
    }

    /* Tighten grid and frame on small screens */
    @media (max-width: 768px) {
      .sponsor-grid {
        grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
        gap: 1rem;
      }
      .sponsor-media {
        aspect-ratio: 15 / 9;
        padding: 0.5rem;
      }
      .sponsor-name {
        margin-top: 0.55rem;
        font-size: 0.95rem;
      }
    }

    /* ====== Competition Image Band (Masonry columns) ====== */
    .competition-band {
      max-width: 1100px;
      margin: 2rem auto 3.5rem;
      padding: 0 1.5rem;
    }
    .competition-frame {
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      border: 2px solid rgba(79,163,209,0.35);
      padding: 1rem;
      background: rgba(0,0,0,0.08);
    }
    .competition-grid {
      column-count: 3;
      column-gap: 1rem;
    }
    @media (max-width: 1024px) { .competition-grid { column-count: 2; } }
    @media (max-width: 600px)  { .competition-grid { column-count: 1; } }

    .competition-item {
      display: inline-block;
      width: 100%;
      margin: 0 0 1rem;
      break-inside: avoid;
      -webkit-column-break-inside: avoid;
      -moz-column-break-inside: avoid;

      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 6px 15px rgba(0,0,0,0.3);
      border: 2px solid rgba(79,163,209,0.35);
      background: rgba(10,31,68,0.85);
    }
    .competition-item img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* ====== Footer ===== */
    footer {
      background: var(--medium-blue);
      color: #dcdcdc;
      text-align: center;
      padding: 1rem 1.5rem;
      font-size: 0.8rem !important;
      line-height: 1.4;
      border-top: 3px solid var(--light-blue);
      margin: 0 auto;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.1);
    }
    footer p { margin: 0.25rem 0; font-weight: 400; font-size: 0.8rem; }

    /* ====== Responsive nav tweaks ====== */
    @media (max-width: 768px) {
      header { min-height: 320px; }
      .nav-login #googleSignIn { width: auto; }
      .nav-toggle { display: block; }
      .nav-links { display: none; }
      .nav-links-mobile { display: none; }
      .nav-links-mobile.show { display: flex; }
      .nav-login .google-btn { width: 90%; justify-content: center; }
    }
  </style>
</head>
<body>

  <!-- ====== Header (image first) ====== -->
  <header>
    <img class="hero-bg" src="assets/group.png" alt="" aria-hidden="true">
    <h1>Our Sponsors</h1>
    <p>
      Trident Robotics 4296 is funded by sponsor funding and donations. Our participation in competitions
      is possible thanks to the generosity of our sponsors.
    </p>
    <button class="sponsor-button" onclick="window.location.href='mailto:sveselack@wths.net'">Sponsor Us</button>
  </header>

  <!-- ====== Navigation (from index.html, below header) ====== -->
  <nav class="site-nav">
    <div class="nav-inner">
      <a class="nav-logo" href="index.html" aria-label="Trident Robotics Home">
        <img src="assets/icon.png" alt="Trident Robotics Logo">
      </a>

      <div class="nav-links" id="navLinks">
        <a href="index.html#about">About</a>
        <a href="index.html#team">Team</a>
        <a href="index.html#updates">Updates</a>
        <a href="index.html#contact">Contact</a>
        <a href="sponsors.html" aria-current="page">Sponsors</a>
        <!-- Tasks link will appear here dynamically -->
        <a href="tasks.html" id="tasksLink" style="display:none;">Tasks</a>
      </div>

      <!-- Mobile-only nav links -->
      <div class="nav-links-mobile" id="navLinksMobile">
        <a href="index.html#about">About</a>
        <a href="index.html#team">Team</a>
        <a href="index.html#updates">Updates</a>
        <a href="index.html#contact">Contact</a>
        <a href="sponsors.html" aria-current="page">Sponsors</a>
        <a href="tasks.html" id="tasksLinkMobile" style="display:none;">Tasks</a>
      </div>

      <div class="nav-login">
        <!-- Container where Google renders Sign-in button -->
        <div id="googleSignIn"></div>

        <!-- Signed-in UI (hidden by default; shown when signed in) -->
        <div id="googleSignedIn" aria-live="polite">
          <img id="googleAvatar" src="" alt="Avatar">
          <span id="googleEmail">Not signed in</span>
          <button id="googleSignOut" class="google-btn" title="Sign out">Sign out</button>
        </div>
      </div>

      <button class="nav-toggle" aria-expanded="false" aria-label="Toggle navigation">
        <span class="hamburger"></span>
      </button>
    </div>
  </nav>

  <!-- ====== Sponsors (dynamic from site.json) ====== -->
  <section class="sponsors-section" aria-labelledby="sponsorHeading">
    <h2 id="sponsorHeading">Current Sponsors</h2>
    <div class="sponsor-grid" id="sponsorGrid">
      <!-- populated dynamically from data/site.json -->
    </div>
  </section>

  <!-- ====== Competition Images (masonry) ====== -->
  <section class="competition-band" aria-labelledby="competitionHeading">
    <h2 id="competitionHeading">Competition Moments</h2>
    <div class="competition-frame">
      <div id="competitionGallery" class="competition-grid"></div>
    </div>
  </section>

  <!-- ====== Footer ====== -->
  <footer>
    <p>© 2025 Trident Robotics 4296. All rights reserved.</p>
    <p>
      This website and its content are independently created and maintained by Lucas Palmquist and members of Trident Robotics 4296. 
      Trident Robotics, the Trident Robotics logo, and all related materials are intellectual property of the team 
      and/or Warren Township High School.
    </p>
    <p>
      All media, graphics, and interactive content are developed for educational and community engagement purposes.
    </p>
  </footer>

  <script>
    // ====== Mobile nav toggle (match index behavior) ======
    document.addEventListener('DOMContentLoaded', function () {
      const navToggle = document.querySelector('.nav-toggle');
      const navLinksMobile = document.getElementById('navLinksMobile');

      navToggle?.addEventListener('click', function () {
        const expanded = navToggle.getAttribute('aria-expanded') === 'true';
        navToggle.setAttribute('aria-expanded', (!expanded).toString());
        navLinksMobile.classList.toggle('show');
      });

      document.querySelectorAll('.nav-links-mobile a').forEach(link => {
        link.addEventListener('click', () => navLinksMobile.classList.remove('show'));
      });
    });

    // ====== Google Sign-In logic (copied from index) ======
    const G_CRED_KEY = 'g_credential_v1';

    function updateTasksVisibility(email) {
      const tasksDesktop = document.getElementById("tasksLink");
      const tasksMobile = document.getElementById("tasksLinkMobile");
      if (!tasksDesktop || !tasksMobile) return;

      if (!email) {
        tasksDesktop.style.display = "none";
        tasksMobile.style.display = "none";
        return;
      }
      const allowedDomains = ["wths.net"];
      const allowedEmails = ["blackshocktrooper@gmail.com"];
      const allowed = allowedDomains.some(domain => email.endsWith(`@${domain}`)) || allowedEmails.includes(email);
      if (allowed) {
        tasksDesktop.style.display = "inline-block";
        tasksMobile.style.display = "block";
      } else {
        tasksDesktop.style.display = "none";
        tasksMobile.style.display = "none";
      }
    }

    function setSignedInUI(profile) {
      const signInContainer = document.getElementById('googleSignIn');
      const signedContainer = document.getElementById('googleSignedIn');
      const emailSpan = document.getElementById('googleEmail');
      const avatarImg = document.getElementById('googleAvatar');

      if (signInContainer) signInContainer.style.display = 'none';
      if (signedContainer) signedContainer.style.display = 'flex';

      if (emailSpan) emailSpan.textContent = profile.email || profile.name || 'Signed in';
      if (avatarImg) avatarImg.src = profile.picture || '/assets/icon.png';

      updateTasksVisibility(profile.email);
    }

    function setSignedOutUI() {
      const signInContainer = document.getElementById('googleSignIn');
      const signedContainer = document.getElementById('googleSignedIn');

      if (signInContainer) signInContainer.style.display = 'block';
      if (signedContainer) signedContainer.style.display = 'none';

      updateTasksVisibility(null);
    }

    function handleCredentialResponse(response) {
      try {
        const data = jwt_decode(response.credential);
        localStorage.setItem(G_CRED_KEY, response.credential);
        setSignedInUI(data);
      } catch (err) {
        console.error('Error decoding credential:', err);
        alert('Sign-in failed (invalid token).');
      }
    }

    function signOut() {
      const raw = localStorage.getItem(G_CRED_KEY);
      if (raw) {
        try {
          const decoded = jwt_decode(raw);
          const email = decoded.email;
          if (google && google.accounts && google.accounts.id && email) {
            try {
              google.accounts.id.revoke(email, (done) => {
                console.log('revoke callback:', done);
              });
            } catch (e) {
              console.warn('revoke call failed', e);
            }
          }
        } catch (e) {
          // ignore decode errors
        }
      }
      localStorage.removeItem(G_CRED_KEY);
      if (google && google.accounts && google.accounts.id) {
        try { google.accounts.id.disableAutoSelect(); } catch(e){}
      }
      setSignedOutUI();
    }

    window.onload = function() {
      // Initialize Google Sign-In
      google.accounts.id.initialize({
        client_id: "635936985251-tj5uq36b5altf4qmk7019r3u504mm1fs.apps.googleusercontent.com",
        callback: handleCredentialResponse,
        auto_select: false
      });

      // Wire up sign out button
      document.addEventListener('click', (e) => {
        if (e.target && e.target.id === 'googleSignOut') {
          signOut();
        }
      });

      // Restore saved credential if present
      const saved = localStorage.getItem(G_CRED_KEY);
      if (saved) {
        try {
          const data = jwt_decode(saved);
          setSignedInUI(data);
          try { google.accounts.id.disableAutoSelect(); } catch(e){}
        } catch (err) {
          console.warn('Stored credential invalid, clearing', err);
          localStorage.removeItem(G_CRED_KEY);
          // render sign-in button below
          google.accounts.id.renderButton(
            document.getElementById("googleSignIn"),
            { theme: "outline", size: "medium", text: "signin_with" }
          );
        }
      } else {
        // Not signed in: render the button
        google.accounts.id.renderButton(
          document.getElementById("googleSignIn"),
          { theme: "outline", size: "medium", text: "signin_with" }
        );
      }
    };
  </script>

  <!-- Load media and sponsors from site.json -->
  <script>
  (async function(){
    try {
      const r = await fetch('/data/site.json?_=' + Date.now());
      if (!r.ok) return;
      const site = await r.json();
      const media = site.media || {};

      // Header hero
      const hero = document.querySelector('header img.hero-bg');
      if (hero && media.sponsorsHeader) hero.src = media.sponsorsHeader;

      // Sponsors grid
      const grid = document.getElementById('sponsorGrid');
      if (grid) {
        let sponsors = Array.isArray(site.sponsors) ? site.sponsors : [
          { name: "Baxter", logo: "assets/Baxter-Logo.png", url: "" },
          { name: "NASA", logo: "assets/NASA-Logo.png", url: "" },
          { name: "Kubota", logo: "assets/Kubota-Logo.png", url: "" },
          { name: "WW Displays Inc", logo: "assets/WWDisplays.png", url: "" },
          { name: "Patel Family", logo: "assets/PatelFamily.png", url: "" }
        ];

        grid.innerHTML = sponsors.map(s => {
          const name = (s && s.name) ? s.name : '';
          const logo = (s && s.logo) ? s.logo : '';
          const url = (s && s.url) ? s.url : '';
          const safeAlt = name ? `${name} logo` : 'Sponsor logo';

          const mediaBlock = `
            <div class="sponsor-media" aria-hidden="true">
              <img class="sponsor-logo" src="${logo}" alt="${safeAlt}" loading="lazy" decoding="async">
            </div>
          `;
          const nameBlock = `<div class="sponsor-name">${name}</div>`;

          if (url) {
            return `
              <article class="sponsor-card">
                <a href="${url}" target="_blank" rel="noopener noreferrer" title="${name}" aria-label="${name} (opens in new tab)">
                  ${mediaBlock}${nameBlock}
                </a>
              </article>
            `;
          } else {
            return `
              <article class="sponsor-card" tabindex="0" aria-label="${name}">
                ${mediaBlock}${nameBlock}
              </article>
            `;
          }
        }).join('');
      }

      // Competition gallery (masonry via CSS columns)
      const gallery = document.getElementById('competitionGallery');
      if (gallery) {
        let images = Array.isArray(media.competitionImages) ? media.competitionImages : [];
        if (!images.length && media.competitionImage) images = [media.competitionImage];
        if (!images.length) images = ['assets/Compitition-Photo1.png'];
        gallery.innerHTML = images.map(url => `
          <div class="competition-item">
            <img src="${url}" alt="Competition moment" loading="lazy" decoding="async">
          </div>
        `).join('');
      }
    } catch(e) { /* ignore */ }
  })();
  </script>
</body>
</html>
