<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link rel="icon" type="image/png" href="/assets/logo.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Settings â€” Trident Robotics</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to bottom, #f0f9ff 60%, #e0e7ef 100%);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      min-height: 100vh;
      position: relative;
      overflow-x: hidden;
    }
    @media (prefers-color-scheme: dark) {
      html, body { color-scheme: dark; }
      body { background: linear-gradient(to bottom, #192132 60%, #0b1220 100%); color: #e5e7eb; }
    }
    .panel { background: white; border: 1px solid #e2e8f0; border-radius: 1rem; box-shadow: 0 1px 2px rgba(2, 6, 23, 0.05); }
    @media (prefers-color-scheme: dark) {
      .panel { background: #0f172a; border-color: #1f2937; box-shadow: 0 1px 2px rgba(2, 6, 23, 0.30); }
    }
    .tabs { display: flex; gap: 2px; background: #f1f5f9; border-radius: 0.5rem; padding: 4px; }
    .tab-btn {
      flex:1; padding: 0.5rem 0; border-radius: 0.5rem; background: none; border: none;
      font-weight: 600; color: #64748b; transition: background 180ms, color 180ms;
      cursor: pointer;
    }
    .tab-btn[aria-selected="true"] {
      background: linear-gradient(90deg, #38bdf8 60%, #818cf8 100%);
      color: white;
      box-shadow: 0 2px 8px rgba(56,189,248,0.09);
    }
    @media (prefers-color-scheme: dark) {
      .tabs { background: #1e293b; }
      .tab-btn { color: #94a3b8; }
    }
    .tab-panel {
      transition: opacity 320ms cubic-bezier(.45,1.5,.65,1), transform 320ms cubic-bezier(.45,1.5,.65,1);
      opacity: 0;
      transform: translateX(24px) scale(.98);
      position: absolute; width: 100%; left: 0; top: 0; z-index: 0;
      pointer-events: none;
      background: inherit;
    }
    .tab-panel.active {
      opacity: 1;
      transform: translateX(0) scale(1);
      pointer-events: auto;
      z-index: 1;
      position: relative;
    }
    .toggle { width: 44px; height: 24px; border-radius: 9999px; background: #e0e7ef; position: relative; cursor: pointer; transition: background 220ms cubic-bezier(.6,1.7,.2,1); border: 1.5px solid #93c5fd; box-shadow: 0 1px 3px rgba(59,130,246,0.08);}
    .toggle.on { background: linear-gradient(90deg, #38bdf8 60%, #818cf8 100%); border-color: #818cf8; }
    .toggle-knob { position: absolute; top: 2px; left: 2px; width: 20px; height: 20px; border-radius: 50%; background: white; box-shadow: 0 2px 6px rgba(59,130,246,0.09); transition: left 240ms cubic-bezier(.7,1.7,.2,1);}
    .toggle.on .toggle-knob { left: 22px; background: #818cf8; }
    .save-btn { background: linear-gradient(90deg, #38bdf8 60%, #818cf8 100%); color: white; font-weight: 600; border: none; border-radius: 0.5rem; padding: 0.5rem 1.5rem; transition: background 180ms, box-shadow 180ms; box-shadow: 0 2px 8px rgba(56,189,248,0.09);}
    .save-btn:active { background: linear-gradient(90deg, #818cf8 0%, #38bdf8 80%);}
    .cancel-btn { background: none; border: 1px solid #e2e8f0; color: #64748b; font-weight: 600; border-radius: 0.5rem; padding: 0.5rem 1.5rem; margin-left: 0.5rem;}
    @media (prefers-color-scheme: dark) {
      .cancel-btn { border-color: #374151; color: #94a3b8;}
    }
    .fadein { animation: fadein 700ms cubic-bezier(.4,2.5,.5,1.1); }
    @keyframes fadein { from { opacity: 0; transform: translateY(24px);} to { opacity: 1; transform: none;} }
    /* --- Floating Gears Animation --- */
    #gear-bg {
      pointer-events: none;
      position: fixed;
      inset: 0;
      width: 100vw;
      height: 100vh;
      z-index: 0;
      overflow: visible;
    }
    .gear {
      filter: drop-shadow(0 2px 8px rgba(56,189,248,0.18));
      opacity: 0.25;
      will-change: transform;
      transition: opacity 0.4s;
    }
    @media (prefers-color-scheme: dark) {
      .gear { opacity: 0.20; }
    }
  </style>
</head>
<body class="min-h-screen p-6">
  <!-- Animated floating gears SVG background -->
  <svg id="gear-bg"></svg>
  <header class="max-w-3xl mx-auto mb-6 px-2 relative z-10">
    <div class="flex items-center gap-3">
      <img src="/assets/logo.png" alt="Trident Robotics Logo" class="h-8 w-8">
      <div>
        <h1 class="text-2xl md:text-3xl font-extrabold text-sky-800 leading-snug dark:text-sky-300">Settings</h1>
        <p class="text-sm text-sky-600 dark:text-sky-400">Manage your Trident Robotics account preferences</p>
      </div>
    </div>
  </header>
  <main class="max-w-3xl mx-auto space-y-6 fadein relative z-10">
    <!-- Tabs Bar -->
    <nav class="tabs mb-2" role="tablist" aria-label="Settings Sections">
      <button class="tab-btn" id="tabBtn1" aria-controls="tabPanel1" aria-selected="true" role="tab" tabindex="0">Account</button>
      <button class="tab-btn" id="tabBtn2" aria-controls="tabPanel2" aria-selected="false" role="tab" tabindex="-1">Notifications</button>
      <button class="tab-btn" id="tabBtn3" aria-controls="tabPanel3" aria-selected="false" role="tab" tabindex="-1">Appearance</button>
      <button class="tab-btn" id="tabBtn4" aria-controls="tabPanel4" aria-selected="false" role="tab" tabindex="-1">Privacy &amp; Security</button>
    </nav>
    <div style="position:relative; min-height:320px;">
      <!-- Account -->
      <form id="tabPanel1" class="tab-panel active panel p-6 space-y-6" role="tabpanel" aria-labelledby="tabBtn1" autocomplete="off">
        <div>
          <label class="block font-semibold mb-1" for="accountEmail">Email</label>
          <input id="accountEmail" name="email" type="email" class="w-full p-2 rounded border border-slate-300 dark:border-slate-700 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-200" placeholder="you@email.com" />
        </div>
        <div>
          <label class="block font-semibold mb-1" for="accountName">Full Name</label>
          <input id="accountName" name="fullname" type="text" class="w-full p-2 rounded border border-slate-300 dark:border-slate-700 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-200" placeholder="Your Name" />
        </div>
        <div class="flex justify-end">
          <button type="submit" class="save-btn">Save</button>
          <button type="reset" class="cancel-btn">Cancel</button>
        </div>
      </form>
      <!-- Notifications -->
      <form id="tabPanel2" class="tab-panel panel p-6 space-y-6" role="tabpanel" aria-labelledby="tabBtn2" autocomplete="off">
        <div>
          <label class="block font-semibold mb-1">Site Notifications</label>
          <div class="flex items-center gap-3">
            <div id="toggleReminders" class="toggle on" tabindex="0" role="switch" aria-checked="true">
              <div class="toggle-knob"></div>
            </div>
            <span id="labelReminders" class="text-sm text-slate-700 dark:text-slate-200">On</span>
            <span class="ml-2 text-xs text-slate-500 dark:text-slate-400">Reminders for calendar events</span>
          </div>
        </div>
        <div>
          <label class="block font-semibold mb-1">Sound on Notification</label>
          <select class="w-full rounded border border-slate-300 dark:border-slate-700 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-200">
            <option>Chime</option>
            <option>Ping</option>
            <option>Pop</option>
            <option>Off</option>
          </select>
        </div>
        <div class="flex justify-end">
          <button type="submit" class="save-btn">Save</button>
          <button type="reset" class="cancel-btn">Cancel</button>
        </div>
      </form>
      <!-- Appearance -->
      <form id="tabPanel3" class="tab-panel panel p-6 space-y-6" role="tabpanel" aria-labelledby="tabBtn3" autocomplete="off">
        <div>
          <label class="block font-semibold mb-1">Theme</label>
          <select class="w-full rounded border border-slate-300 dark:border-slate-700 bg-slate-100 dark:bg-slate-800 text-slate-900 dark:text-slate-200">
            <option>System</option>
            <option>Light</option>
            <option>Dark</option>
            <option>High Contrast</option>
          </select>
        </div>
        <div>
          <label class="block font-semibold mb-1">Reduce Motion</label>
          <div class="flex items-center gap-3">
            <div id="toggleReduceMotion" class="toggle" tabindex="0" role="switch" aria-checked="false">
              <div class="toggle-knob"></div>
            </div>
            <span id="labelReduceMotion" class="text-sm text-slate-700 dark:text-slate-200">Off</span>
          </div>
        </div>
        <div class="flex justify-end">
          <button type="submit" class="save-btn">Save</button>
          <button type="reset" class="cancel-btn">Cancel</button>
        </div>
      </form>
      <!-- Privacy & Security -->
      <form id="tabPanel4" class="tab-panel panel p-6 space-y-6" role="tabpanel" aria-labelledby="tabBtn4" autocomplete="off">
        <div>
          <label class="block font-semibold mb-1">Allow Data Collection</label>
          <div class="flex items-center gap-3">
            <div id="toggleDataCollection" class="toggle on" tabindex="0" role="switch" aria-checked="true">
              <div class="toggle-knob"></div>
            </div>
            <span id="labelDataCollection" class="text-sm text-slate-700 dark:text-slate-200">On</span>
            <span class="ml-2 text-xs text-slate-500 dark:text-slate-400">Default On</span>
          </div>
        </div>
        <div class="flex justify-end">
          <button type="submit" class="save-btn">Save</button>
          <button type="reset" class="cancel-btn">Cancel</button>
        </div>
      </form>
    </div>
  </main>
  <script>
    // --- Floating Gears Background Animation ---
    // Generates multiple SVG gears with random movement/rotation
    const gearColors = [
      "#38bdf8", "#818cf8", "#64748b", "#facc15", "#0ea5e9"
    ];
    const darkGearColors = [
      "#818cf8", "#38bdf8", "#64748b", "#facc15", "#0ea5e9"
    ];
    const bg = document.getElementById('gear-bg');
    function createGear(cx, cy, r, teeth, fill, id) {
      // Generate gear path
      let path = "";
      for (let i = 0; i < teeth; i++) {
        const a = ((2 * Math.PI) / teeth) * i;
        const outer = r * 1.14, inner = r * 0.86;
        const x1 = cx + outer * Math.cos(a), y1 = cy + outer * Math.sin(a);
        const x2 = cx + r * Math.cos(a + Math.PI / teeth), y2 = cy + r * Math.sin(a + Math.PI / teeth);
        path += `${i === 0 ? "M" : "L"}${x1},${y1}L${x2},${y2}`;
      }
      path += "Z";
      return `<g id="gear-${id}"><circle cx="${cx}" cy="${cy}" r="${r*0.65}" fill="${fill}" /><path d="${path}" fill="${fill}" /></g>`;
    }
    function randomBetween(a, b) {
      return a + Math.random() * (b - a);
    }
    function renderGears() {
      let w = window.innerWidth, h = window.innerHeight;
      let gears = [];
      // Choose a color set based on theme
      const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      const colors = isDark ? darkGearColors : gearColors;
      for (let i = 0; i < 7; i++) {
        let cx = randomBetween(0, w), cy = randomBetween(0, h);
        let r = randomBetween(38, 80);
        let t = Math.floor(randomBetween(8, 16));
        let color = colors[i % colors.length];
        gears.push(createGear(cx, cy, r, t, color, i));
      }
      bg.innerHTML = gears.join('');
      // Animate
      Array.from(bg.children).forEach((gear, idx) => {
        gear.classList.add("gear");
        animateGear(gear, idx);
      });
    }
    function animateGear(gear, idx) {
      const w = window.innerWidth, h = window.innerHeight;
      let angle = randomBetween(0, 360);
      let speed = randomBetween(12, 30) * (Math.random() < 0.5 ? 1 : -1); // deg/sec
      let x = randomBetween(0, w), y = randomBetween(0, h);
      let size = randomBetween(0.8, 1.2);
      function step(ts) {
        angle += speed * 0.016; // ~60fps
        x += Math.sin((angle+idx*60)/60) * 0.1;
        y += Math.cos((angle+idx*80)/80) * 0.09;
        if (x < -120) x = w+120; if (x > w+120) x = -120;
        if (y < -120) y = h+120; if (y > h+120) y = -120;
        gear.setAttribute('transform', `translate(${x},${y}) scale(${size}) rotate(${angle})`);
        gear.style.opacity = (0.12 + Math.abs(Math.sin(angle/80))*0.18).toFixed(2);
        requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }
    window.addEventListener('resize', renderGears);
    renderGears();

    // --- Sound Engine from ui-lab.html ---
    const Sound = (() => {
      const state = {
        ctx: null,
        master: null,
        enabled: true,
        prefersReduced: window.matchMedia('(prefers-reduced-motion: reduce)').matches
      };
      function ensureCtx() {
        if (!state.ctx) {
          const ctx = new (window.AudioContext || window.webkitAudioContext)();
          const master = ctx.createGain();
          master.gain.value = 0.6;
          master.connect(ctx.destination);
          state.ctx = ctx;
          state.master = master;
          // Resume on first user gesture if needed
          const resume = () => { if (ctx.state === 'suspended') ctx.resume(); document.removeEventListener('pointerdown', resume, true); };
          document.addEventListener('pointerdown', resume, true);
        }
      }
      function setEnabled(on) {
        state.enabled = on;
        if (state.master) state.master.gain.value = on ? 0.6 : 0.0;
      }
      function tone({ freq=440, type='sine', duration=0.12, attack=0.005, decay=0.08, gain=0.3, detune=0 }) {
        if (!state.enabled) return;
        ensureCtx();
        const t0 = state.ctx.currentTime;
        const osc = state.ctx.createOscillator();
        const g = state.ctx.createGain();
        osc.type = type;
        osc.frequency.setValueAtTime(freq, t0);
        if (detune) osc.detune.setValueAtTime(detune, t0);
        g.gain.setValueAtTime(0, t0);
        g.gain.linearRampToValueAtTime(gain, t0 + attack);
        g.gain.exponentialRampToValueAtTime(0.0001, t0 + attack + decay);
        osc.connect(g).connect(state.master);
        osc.start(t0);
        osc.stop(t0 + Math.max(duration, attack + decay));
      }
      function click() { tone({ freq: 240, type: 'triangle', duration: 0.08, attack: 0.002, decay: 0.06, gain: 0.22 }); }
      function success() { tone({ freq: 660, type: 'sine', attack: 0.004, decay: 0.10, gain: 0.25 }); setTimeout(() => tone({ freq: 880, type: 'sine', attack: 0.004, decay: 0.12, gain: 0.23 }), 90);}
      function warn() { tone({ freq: 320, type: 'square', attack: 0.003, decay: 0.15, gain: 0.2 }); }
      function error() { tone({ freq: 220, type: 'square', attack: 0.002, decay: 0.2, gain: 0.25 }); setTimeout(() => tone({ freq: 180, type: 'square', attack: 0.002, decay: 0.22, gain: 0.22 }), 90);}
      function info() { tone({ freq: 520, type: 'triangle', attack: 0.004, decay: 0.12, gain: 0.22 }); }
      function tab() { tone({ freq: 700, type: 'triangle', attack: 0.004, decay: 0.11, gain: 0.19 }); }
      function toggle() { tone({ freq: 380, type: 'square', attack: 0.002, decay: 0.10, gain: 0.18 }); }
      return { setEnabled, click, success, warn, error, info, tab, toggle };
    })();

    // Tabs (animated, motion-safe)
    const tabBtns = [document.getElementById('tabBtn1'), document.getElementById('tabBtn2'), document.getElementById('tabBtn3'), document.getElementById('tabBtn4')];
    const tabPanels = [document.getElementById('tabPanel1'), document.getElementById('tabPanel2'), document.getElementById('tabPanel3'), document.getElementById('tabPanel4')];
    tabBtns.forEach((btn, idx) => {
      btn.addEventListener('click', () => {
        tabBtns.forEach((b,i) => {
          b.setAttribute('aria-selected', i === idx);
          b.tabIndex = i === idx ? 0 : -1;
        });
        tabPanels.forEach((panel,i) => {
          panel.classList.toggle('active', i === idx);
        });
        Sound.tab();
      });
      btn.addEventListener('keydown', function(e) {
        if (e.key === "ArrowLeft" || e.key === "ArrowRight") {
          let dir = e.key === "ArrowLeft" ? -1 : 1;
          let next = (idx + dir + tabBtns.length) % tabBtns.length;
          tabBtns[next].focus();
        }
      });
    });

    // Toggle switches, sound and animated (motion-safe)
    function setupToggle(id, labelId, onText="On", offText="Off") {
      const el = document.getElementById(id);
      const label = document.getElementById(labelId);
      let state = el.classList.contains('on');
      function set(stateVal) {
        state = !!stateVal;
        el.classList.toggle('on', state);
        el.setAttribute('aria-checked', state);
        if (label) label.textContent = state ? onText : offText;
      }
      function spring() {
        set(!state);
        Sound.toggle();
        if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
          el.animate([
            { transform: 'scale(1)' },
            { transform: 'scale(1.12)' },
            { transform: 'scale(1)' }
          ], { duration: 240, easing: 'cubic-bezier(.7,1.7,.2,1)' });
        }
      }
      if (el) {
        el.addEventListener('click', spring);
        el.addEventListener('keydown', function(e) {
          if (e.key === ' ' || e.key === 'Enter') { e.preventDefault(); spring(); }
        });
      }
      return { set };
    }
    setupToggle('toggleReminders', 'labelReminders');
    setupToggle('toggleReduceMotion', 'labelReduceMotion');
    setupToggle('toggleDataCollection', 'labelDataCollection');

    // Save/cancel (demo only: show toast)
    document.querySelectorAll("form").forEach(form=>{
      form.addEventListener('submit', e=>{
        e.preventDefault();
        Sound.tab();
        if(window.Toast) Toast("Settings saved.", "success");
      });
      form.addEventListener('reset', e=>{
        Sound.toggle();
        if(window.Toast) Toast("Changes canceled.", "info");
      });
    });
    // Demo toast
    window.Toast = function(msg, type){
      let el = document.createElement("div");
      el.className = "fixed right-6 top-6 z-50 px-4 py-2 rounded bg-sky-600 text-white font-semibold shadow-lg fadein";
      el.textContent = msg;
      document.body.appendChild(el);
      setTimeout(()=>el.remove(), 2200);
    }

    // --- Autofill email if signed in (simulate) ---
    document.addEventListener("DOMContentLoaded", function() {
      // Simulate getting user email from JS variable or backend API
      var signedInEmail = window.signedInEmail || "darkshockgamer@email.com";
      document.getElementById("accountEmail").value = signedInEmail;
    });
  </script>
  <script src="/assets/js/settings.js"></script>
</body>
</html>
