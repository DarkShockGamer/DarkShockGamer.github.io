<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trident Robotics Task Board</title>
  <!-- Tailwind CSS CDN for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.6.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.6.0/firebase-auth-compat.js"></script>
  <!-- SortableJS for drag & drop -->
  <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
</head>
<body class="bg-sky-50 min-h-screen flex flex-col items-center">

  <!-- Header -->
  <header class="w-full bg-sky-700 text-white p-4 flex justify-between items-center">
    <h1 class="text-xl font-bold">Trident Robotics — Task Board</h1>
    <button id="logout-btn" class="hidden text-sm underline" onclick="logout()">Log Out</button>
  </header>

  <!-- Authentication Section -->
  <div id="auth-container" class="mt-20 flex flex-col items-center">
    <button id="login-btn" onclick="signIn()" class="bg-sky-600 hover:bg-sky-700 text-white px-6 py-3 rounded-lg font-bold shadow-lg">
      Sign in with School Google Account
    </button>
    <button id="taskboard-btn" style="display:none;" onclick="openTaskBoard()" class="bg-sky-600 hover:bg-sky-700 text-white px-6 py-3 rounded-lg font-bold shadow-lg mt-4">
      Open Task Board
    </button>
    <p id="access-denied" class="text-red-600 mt-4 hidden">Access Denied — must sign in with your school email.</p>
  </div>

  <!-- Task Board Container -->
  <div id="taskboard-container" class="hidden w-full max-w-6xl mt-10 flex gap-4 px-4">
    <!-- Columns will go here -->
    <div class="column bg-sky-100 rounded-2xl p-4 w-1/3 min-h-[400px]">
      <h2 class="font-semibold text-sky-700 mb-3">To Do</h2>
      <div class="task bg-sky-700 text-white px-3 py-2 rounded-md mb-2 cursor-grab">Design intake hatch</div>
      <div class="task bg-sky-700 text-white px-3 py-2 rounded-md mb-2 cursor-grab">Setup CI for codebase</div>
    </div>
    <div class="column bg-sky-100 rounded-2xl p-4 w-1/3 min-h-[400px]">
      <h2 class="font-semibold text-sky-700 mb-3">In Progress</h2>
    </div>
    <div class="column bg-sky-100 rounded-2xl p-4 w-1/3 min-h-[400px]">
      <h2 class="font-semibold text-sky-700 mb-3">Done</h2>
    </div>
  </div>

  <!-- Firebase & Taskboard Scripts -->
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    const allowedDomain = "@myschool.org"; // change to your school email domain

    // Sign in
    function signIn() {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider);
    }

    // Sign out
    function logout() {
      auth.signOut();
    }

    // Auth state check
    auth.onAuthStateChanged(user => {
      const loginBtn = document.getElementById("login-btn");
      const taskBtn = document.getElementById("taskboard-btn");
      const accessDenied = document.getElementById("access-denied");
      const logoutBtn = document.getElementById("logout-btn");

      if(user && user.email.endsWith(allowedDomain)) {
        loginBtn.style.display = "none";
        taskBtn.style.display = "inline-block";
        logoutBtn.style.display = "inline-block";
        accessDenied.style.display = "none";
      } else if(user) {
        loginBtn.style.display = "none";
        taskBtn.style.display = "none";
        accessDenied.style.display = "block";
        logoutBtn.style.display = "inline-block";
      } else {
        loginBtn.style.display = "inline-block";
        taskBtn.style.display = "none";
        accessDenied.style.display = "none";
        logoutBtn.style.display = "none";
      }
    });

    // Open Task Board
    function openTaskBoard() {
      document.getElementById("taskboard-container").style.display = "flex";
      document.getElementById("taskboard-btn").style.display = "none";
      initSortable();
    }

    // Initialize SortableJS for drag & drop
    function initSortable() {
      const columns = document.querySelectorAll(".column");
      columns.forEach(col => {
        new Sortable(col, {
          group: "tasks",
          animation: 150
        });
      });
    }
  </script>

</body>
</html>
